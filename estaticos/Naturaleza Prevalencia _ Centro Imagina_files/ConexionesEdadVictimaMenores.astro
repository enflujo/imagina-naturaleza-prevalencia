import { edadVictimas } from "/src/cerebro/datos.ts?t=1732593999676";
import info from "/src/modulos/info.ts";
import { definirDims } from "/src/utilidades/ayudasConexiones.ts";
import { convertirEscala } from "/node_modules/.vite/deps/@enflujo_alquimia.js?v=605cc3c2";
const svg = document.querySelector("#conexiones4");
if (!svg) throw new Error("No se encontrÃ³ el elemento SVG");
const semillas = svg.querySelector(".semillas");
const conexiones = svg.querySelector(".conexiones");
const contenedorInfo = info.elemento();
const { mujeres, hombres } = edadVictimas.vida.entre13y17;
const { alto, margenY, espacioEntre, margenCentro } = definirDims(600);
const llaves = Object.keys(edadVictimas.nombres).filter((nombre) => nombre !== "n");
const coloresGrupos = {
  menor14: "#69d2e7",
  entre14y15: "#ecd078",
  entre16y17: "#83af9b"
};
const crearMensaje = (conexion, nombreGrupo, lado) => {
  const genero = lado === "izq" ? "female" : "male";
  let mensaje = `In <span class="resaltar agrandar1-2 subrayar">${conexion.pais}</span>,`;
  mensaje += `<span class="resaltar agrandar1-4${conexion.valor >= 10 ? " grave" : ""}"> ${conexion.valor}%</span> of <span class="resaltar subrayar">${genero} victims</span>`;
  mensaje += ` say that their first perpetration happened between the ages of: <span class="resaltar agrandar1-2">${nombreGrupo}</span>.`;
  return mensaje;
};
const origenesMujeres = procesarGrupoEtario(mujeres);
const origenesHombres = procesarGrupoEtario(hombres);
const paises = [];
[...origenesMujeres[0].conexiones, ...origenesHombres[0].conexiones].forEach((lugar, i) => {
  if (!paises.find((pais) => pais.nombre === lugar.pais)) {
    paises.push({ nombre: lugar.pais, y: margenY + espacioEntre * (i + 1) + alto(i * 2) });
  }
});
definirConexiones();
crearGrupo(origenesMujeres, "izq");
crearGrupo(origenesHombres, "der");
crearInteracciones();
paises.forEach((pais) => {
  const grupo = document.createElementNS("http://www.w3.org/2000/svg", "g");
  grupo.setAttribute("class", "pais");
  grupo.setAttribute("style", `transform: translate(50%, ${pais.y}px);`);
  const eje = document.createElementNS("http://www.w3.org/2000/svg", "rect");
  eje.setAttribute("x", `-50`);
  eje.setAttribute("y", "0");
  eje.setAttribute("width", "100");
  eje.setAttribute("height", `${alto(10.5)}`);
  eje.setAttribute("fill", "#5b5e5d");
  const nombre = document.createElementNS("http://www.w3.org/2000/svg", "text");
  nombre.setAttribute("x", "0");
  nombre.setAttribute("y", `${alto(6.5)}px`);
  nombre.setAttribute("font-weight", "bold");
  nombre.setAttribute("font-size", "15");
  nombre.setAttribute("text-anchor", "middle");
  nombre.setAttribute("fill", "rgba(0,0,0,1)");
  nombre.innerHTML = pais.nombre;
  grupo.appendChild(eje);
  grupo.appendChild(nombre);
  svg?.appendChild(grupo);
});
function crearGrupo(grupo, lado) {
  grupo.forEach((origen) => {
    const grupo2 = document.createElementNS("http://www.w3.org/2000/svg", "g");
    grupo2.setAttribute("class", "origen");
    const xGrupo = lado === "izq" ? "3px" : "calc(100% - 5px)";
    grupo2.setAttribute(
      "style",
      `transform: translate(${xGrupo}, ${origen.y}px);fill:${coloresGrupos[origen.llave]};`
    );
    const nombreGrupo = edadVictimas.nombres[origen.llave];
    const semilla = document.createElementNS("http://www.w3.org/2000/svg", "rect");
    semilla.setAttribute("x", lado === "izq" ? "0" : "-40px");
    semilla.setAttribute("y", "0");
    semilla.setAttribute("width", "40px");
    semilla.setAttribute("height", `${alto(origen.valor)}px`);
    const nombre = document.createElementNS("http://www.w3.org/2000/svg", "text");
    nombre.setAttribute("x", "0");
    nombre.setAttribute("y", "-17px");
    nombre.setAttribute("font-weight", "bold");
    nombre.setAttribute("font-size", "15");
    if (lado === "der") nombre.setAttribute("text-anchor", "end");
    nombre.innerHTML = nombreGrupo;
    const valor = document.createElementNS("http://www.w3.org/2000/svg", "text");
    valor.setAttribute("x", "0");
    valor.setAttribute("y", "-3px");
    valor.setAttribute("font-size", "11");
    if (lado === "der") valor.setAttribute("text-anchor", "end");
    valor.innerHTML = `${origen.valor}%`;
    origen.conexiones.forEach((conexion) => {
      const elemento = document.createElementNS("http://www.w3.org/2000/svg", "path");
      elemento.setAttribute("class", `conexion c${origen.llave}`);
      elemento.setAttribute("d", curva(conexion, lado));
      elemento.setAttribute("fill", conexion.color);
      elemento.setAttribute("data-datos", JSON.stringify(conexion));
      elemento.setAttribute("data-lado", lado);
      elemento.addEventListener("mouseenter", () => {
        contenedorInfo.innerHTML = crearMensaje(conexion, nombreGrupo, lado);
        svg?.classList.add("interactuando");
        info.mostrar();
        elemento.classList.add("activo");
      });
      elemento.addEventListener("mouseleave", () => {
        svg?.querySelector(".conexion.activo")?.classList.remove("activo");
        info.esconder();
        svg?.classList.remove("interactuando");
      });
      elemento.addEventListener("mousemove", (evento) => {
        Object.assign(contenedorInfo.style, {
          top: `${evento.pageY - contenedorInfo.clientHeight - 10}px`,
          left: `${evento.pageX}px`
        });
      });
      conexiones?.appendChild(elemento);
    });
    grupo2.appendChild(semilla);
    grupo2.appendChild(nombre);
    grupo2.appendChild(valor);
    semillas?.append(grupo2);
  });
}
function procesarGrupoEtario(grupo) {
  let yAcumulado = 0;
  return llaves.sort((a, b) => grupo.totales[b] - grupo.totales[a]).map((nombre, i) => {
    const valor = grupo.totales[nombre];
    const y = espacioEntre * (i + 1) + margenY + yAcumulado;
    const acumulados = { menor14: 0, entre14y15: 0, entre16y17: 0 };
    const conexiones2 = grupo.datos.map((lugar) => {
      const valorLinea = lugar[nombre];
      acumulados[nombre] += valorLinea;
      return {
        pais: lugar.pais,
        origen: nombre,
        valor: valorLinea,
        origenY1: 0,
        origenY2: 0,
        destinoY1: 0,
        destinoY2: 0,
        color: coloresGrupos[nombre]
      };
    }).sort((a, b) => b.valor - a.valor);
    const respuesta = {
      llave: nombre,
      y,
      valor,
      conexiones: conexiones2,
      totalOrigen: acumulados[nombre] | 0
    };
    yAcumulado += alto(valor);
    return respuesta;
  });
}
function definirConexiones() {
  origenesMujeres.forEach((origen, i) => {
    const escalaYOrigen = (n) => alto(convertirEscala(n, 0, origen.totalOrigen, 0, origen.valor - 4.4));
    const escalaYDestino = (n) => alto(convertirEscala(n, 0, 100, 0, 10));
    origen.conexiones.forEach((lugar, ii) => {
      const pais = paises.find((pais2) => pais2.nombre === lugar.pais);
      const y2 = i > 0 ? origenesMujeres[i - 1].conexiones.find((l) => l.pais === lugar.pais)?.destinoY2 : pais?.y;
      lugar.origenY1 = ii === 0 ? origen.y : origen.conexiones[ii - 1].origenY2;
      lugar.origenY2 = lugar.origenY1;
      lugar.origenY2 += escalaYOrigen(lugar.valor);
      lugar.destinoY1 = y2 || 0;
      lugar.destinoY2 = lugar.destinoY1;
      lugar.destinoY2 += escalaYDestino(lugar.valor) | 0;
    });
  });
  origenesMujeres.reverse();
  origenesHombres.forEach((destino, i) => {
    const escalaYOrigen = (n) => alto(convertirEscala(n, 0, 100, 0, 10));
    const escalaYDestino = (n) => alto(convertirEscala(n, 0, destino.totalOrigen, 0, destino.valor - 2));
    destino.conexiones.forEach((lugar, ii) => {
      const pais = paises.find((pais2) => pais2.nombre === lugar.pais);
      const y1 = i === 0 ? pais?.y : origenesHombres[i - 1].conexiones.find((l) => l.pais === lugar.pais)?.origenY2;
      lugar.origenY1 = y1 || 0;
      lugar.origenY2 = lugar.origenY1;
      lugar.origenY2 += escalaYOrigen(lugar.valor);
      lugar.destinoY1 = ii === 0 ? destino.y : destino.conexiones[ii - 1].destinoY2;
      lugar.destinoY2 = lugar.destinoY1;
      lugar.destinoY2 += escalaYDestino(lugar.valor) | 0;
    });
  });
  origenesHombres.reverse();
}
function curva(conexion, lado) {
  const anchoGrafica = svg?.clientWidth || 0;
  const mitad = anchoGrafica / 2;
  const centroCurva = lado === "izq" ? mitad / 2 - margenCentro : mitad + margenCentro + mitad / 2;
  const xOrigen = lado === "izq" ? 40 : mitad + margenCentro;
  const xDestino = lado === "izq" ? mitad - margenCentro : anchoGrafica - 44;
  const x1 = centroCurva;
  const x2 = centroCurva;
  const y1 = conexion.origenY1;
  const y2 = conexion.destinoY1;
  let forma = `M${xOrigen},${conexion.origenY1}`;
  forma += ` C${x1},${y1}`;
  forma += ` ${x2},${y2}`;
  forma += ` ${xDestino},${conexion.destinoY1}`;
  forma += `L${xDestino},${conexion.destinoY2}`;
  const x3 = centroCurva;
  const y3 = conexion.destinoY2;
  const x4 = centroCurva;
  const y4 = conexion.origenY2;
  forma += ` C${x3},${y3}`;
  forma += ` ${x4},${y4}`;
  forma += ` ${xOrigen},${conexion.origenY2}`;
  forma += "Z";
  return forma;
}
window.addEventListener("resize", () => {
  if (!svg) return;
  const conexiones2 = svg.querySelectorAll(".conexion");
  if (conexiones2.length) {
    conexiones2.forEach((conexion) => {
      const { datos, lado } = conexion.dataset;
      if (datos && lado) conexion.setAttribute("d", curva(JSON.parse(datos), lado));
    });
  }
});
function crearInteracciones() {
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNvbmV4aW9uZXNFZGFkVmljdGltYU1lbm9yZXMuYXN0cm8iXSwic291cmNlc0NvbnRlbnQiOlsiLS0tXHJcblxyXG4tLS1cclxuXHJcbjxkaXYgY2xhc3M9XCJjb250ZW5lZG9yQ29uZXhpb25lc1wiPlxyXG4gIDxzdmcgd2lkdGg9XCIxMDAlXCIgaGVpZ2h0PVwiODAwcHhcIiBpZD1cImNvbmV4aW9uZXM0XCIgY2xhc3M9XCJncmFmaWNhQ29uZXhpb25lc1wiPlxyXG4gICAgPHRleHQgeD1cIjI1JVwiIHk9XCIyMHB4XCIgY2xhc3M9XCJub21icmVDb2x1bW5hXCIgdGV4dC1hbmNob3I9XCJtaWRkbGVcIj5EYXRhIGZvciBmZW1hbGUgdmljdGltczwvdGV4dD5cclxuICAgIDx0ZXh0IHg9XCI3NSVcIiB5PVwiMjBweFwiIGNsYXNzPVwibm9tYnJlQ29sdW1uYVwiIHRleHQtYW5jaG9yPVwibWlkZGxlXCI+RGF0YSBmb3IgbWFsZSB2aWN0aW1zPC90ZXh0PlxyXG4gICAgPGcgY2xhc3M9XCJjb25leGlvbmVzXCI+PC9nPlxyXG4gICAgPGcgY2xhc3M9XCJzZW1pbGxhc1wiPjwvZz5cclxuICA8L3N2Zz5cclxuPC9kaXY+XHJcblxyXG48c2NyaXB0PlxyXG4gIGltcG9ydCB7IGVkYWRWaWN0aW1hcyB9IGZyb20gJ0AvY2VyZWJyby9kYXRvcyc7XHJcbiAgaW1wb3J0IGluZm8gZnJvbSAnQC9tb2R1bG9zL2luZm8nO1xyXG4gIGltcG9ydCB0eXBlIHsgQ29uZXhpb24sIEdydXBvQ29uZXhpb24sIExsYXZlc0VWLCBHcnVwb0VWIH0gZnJvbSAnQC90aXBvcyc7XHJcbiAgaW1wb3J0IHsgZGVmaW5pckRpbXMgfSBmcm9tICdAL3V0aWxpZGFkZXMvYXl1ZGFzQ29uZXhpb25lcyc7XHJcbiAgaW1wb3J0IHsgY29udmVydGlyRXNjYWxhIH0gZnJvbSAnQGVuZmx1am8vYWxxdWltaWEnO1xyXG5cclxuICBjb25zdCBzdmcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yPFNWR0FFbGVtZW50PignI2NvbmV4aW9uZXM0Jyk7XHJcbiAgaWYgKCFzdmcpIHRocm93IG5ldyBFcnJvcignTm8gc2UgZW5jb250csOzIGVsIGVsZW1lbnRvIFNWRycpO1xyXG4gIGNvbnN0IHNlbWlsbGFzID0gc3ZnLnF1ZXJ5U2VsZWN0b3I8U1ZHR0VsZW1lbnQ+KCcuc2VtaWxsYXMnKTtcclxuICBjb25zdCBjb25leGlvbmVzID0gc3ZnLnF1ZXJ5U2VsZWN0b3I8U1ZHR0VsZW1lbnQ+KCcuY29uZXhpb25lcycpO1xyXG5cclxuICBjb25zdCBjb250ZW5lZG9ySW5mbyA9IGluZm8uZWxlbWVudG8oKTtcclxuICBjb25zdCB7IG11amVyZXMsIGhvbWJyZXMgfSA9IGVkYWRWaWN0aW1hcy52aWRhLmVudHJlMTN5MTc7XHJcbiAgY29uc3QgeyBhbHRvLCBtYXJnZW5ZLCBlc3BhY2lvRW50cmUsIG1hcmdlbkNlbnRybyB9ID0gZGVmaW5pckRpbXMoNjAwKTtcclxuICBjb25zdCBsbGF2ZXMgPSBPYmplY3Qua2V5cyhlZGFkVmljdGltYXMubm9tYnJlcykuZmlsdGVyKChub21icmUpID0+IG5vbWJyZSAhPT0gJ24nKTtcclxuXHJcbiAgY29uc3QgY29sb3Jlc0dydXBvcyA9IHtcclxuICAgIG1lbm9yMTQ6ICcjNjlkMmU3JyxcclxuICAgIGVudHJlMTR5MTU6ICcjZWNkMDc4JyxcclxuICAgIGVudHJlMTZ5MTc6ICcjODNhZjliJyxcclxuICB9O1xyXG4gIGNvbnN0IGNyZWFyTWVuc2FqZSA9IChjb25leGlvbjogQ29uZXhpb24sIG5vbWJyZUdydXBvOiBzdHJpbmcsIGxhZG86ICdpenEnIHwgJ2RlcicpID0+IHtcclxuICAgIGNvbnN0IGdlbmVybyA9IGxhZG8gPT09ICdpenEnID8gJ2ZlbWFsZScgOiAnbWFsZSc7XHJcbiAgICBsZXQgbWVuc2FqZSA9IGBJbiA8c3BhbiBjbGFzcz1cInJlc2FsdGFyIGFncmFuZGFyMS0yIHN1YnJheWFyXCI+JHtjb25leGlvbi5wYWlzfTwvc3Bhbj4sYDtcclxuICAgIG1lbnNhamUgKz0gYDxzcGFuIGNsYXNzPVwicmVzYWx0YXIgYWdyYW5kYXIxLTQke2NvbmV4aW9uLnZhbG9yID49IDEwID8gJyBncmF2ZScgOiAnJ31cIj4gJHtjb25leGlvbi52YWxvcn0lPC9zcGFuPiBvZiA8c3BhbiBjbGFzcz1cInJlc2FsdGFyIHN1YnJheWFyXCI+JHtnZW5lcm99IHZpY3RpbXM8L3NwYW4+YDtcclxuICAgIG1lbnNhamUgKz0gYCBzYXkgdGhhdCB0aGVpciBmaXJzdCBwZXJwZXRyYXRpb24gaGFwcGVuZWQgYmV0d2VlbiB0aGUgYWdlcyBvZjogPHNwYW4gY2xhc3M9XCJyZXNhbHRhciBhZ3JhbmRhcjEtMlwiPiR7bm9tYnJlR3J1cG99PC9zcGFuPi5gO1xyXG4gICAgcmV0dXJuIG1lbnNhamU7XHJcbiAgfTtcclxuXHJcbiAgY29uc3Qgb3JpZ2VuZXNNdWplcmVzID0gcHJvY2VzYXJHcnVwb0V0YXJpbyhtdWplcmVzKTtcclxuICBjb25zdCBvcmlnZW5lc0hvbWJyZXMgPSBwcm9jZXNhckdydXBvRXRhcmlvKGhvbWJyZXMpO1xyXG4gIGNvbnN0IHBhaXNlczogeyBub21icmU6IHN0cmluZzsgeTogbnVtYmVyIH1bXSA9IFtdO1xyXG5cclxuICBbLi4ub3JpZ2VuZXNNdWplcmVzWzBdLmNvbmV4aW9uZXMsIC4uLm9yaWdlbmVzSG9tYnJlc1swXS5jb25leGlvbmVzXS5mb3JFYWNoKChsdWdhciwgaSkgPT4ge1xyXG4gICAgaWYgKCFwYWlzZXMuZmluZCgocGFpcykgPT4gcGFpcy5ub21icmUgPT09IGx1Z2FyLnBhaXMpKSB7XHJcbiAgICAgIHBhaXNlcy5wdXNoKHsgbm9tYnJlOiBsdWdhci5wYWlzLCB5OiBtYXJnZW5ZICsgZXNwYWNpb0VudHJlICogKGkgKyAxKSArIGFsdG8oaSAqIDIpIH0pO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICBkZWZpbmlyQ29uZXhpb25lcygpO1xyXG4gIGNyZWFyR3J1cG8ob3JpZ2VuZXNNdWplcmVzLCAnaXpxJyk7XHJcbiAgY3JlYXJHcnVwbyhvcmlnZW5lc0hvbWJyZXMsICdkZXInKTtcclxuICBjcmVhckludGVyYWNjaW9uZXMoKTtcclxuXHJcbiAgcGFpc2VzLmZvckVhY2goKHBhaXMpID0+IHtcclxuICAgIGNvbnN0IGdydXBvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdnJyk7XHJcbiAgICBncnVwby5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ3BhaXMnKTtcclxuICAgIGdydXBvLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCBgdHJhbnNmb3JtOiB0cmFuc2xhdGUoNTAlLCAke3BhaXMueX1weCk7YCk7XHJcblxyXG4gICAgY29uc3QgZWplID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdyZWN0Jyk7XHJcbiAgICBlamUuc2V0QXR0cmlidXRlKCd4JywgYC01MGApO1xyXG4gICAgZWplLnNldEF0dHJpYnV0ZSgneScsICcwJyk7XHJcbiAgICBlamUuc2V0QXR0cmlidXRlKCd3aWR0aCcsICcxMDAnKTtcclxuICAgIGVqZS5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsIGAke2FsdG8oMTAuNSl9YCk7XHJcbiAgICBlamUuc2V0QXR0cmlidXRlKCdmaWxsJywgJyM1YjVlNWQnKTtcclxuXHJcbiAgICBjb25zdCBub21icmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3RleHQnKTtcclxuICAgIG5vbWJyZS5zZXRBdHRyaWJ1dGUoJ3gnLCAnMCcpO1xyXG4gICAgbm9tYnJlLnNldEF0dHJpYnV0ZSgneScsIGAke2FsdG8oNi41KX1weGApO1xyXG4gICAgbm9tYnJlLnNldEF0dHJpYnV0ZSgnZm9udC13ZWlnaHQnLCAnYm9sZCcpO1xyXG4gICAgbm9tYnJlLnNldEF0dHJpYnV0ZSgnZm9udC1zaXplJywgJzE1Jyk7XHJcbiAgICBub21icmUuc2V0QXR0cmlidXRlKCd0ZXh0LWFuY2hvcicsICdtaWRkbGUnKTtcclxuICAgIG5vbWJyZS5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCAncmdiYSgwLDAsMCwxKScpO1xyXG4gICAgbm9tYnJlLmlubmVySFRNTCA9IHBhaXMubm9tYnJlO1xyXG5cclxuICAgIGdydXBvLmFwcGVuZENoaWxkKGVqZSk7XHJcbiAgICBncnVwby5hcHBlbmRDaGlsZChub21icmUpO1xyXG5cclxuICAgIHN2Zz8uYXBwZW5kQ2hpbGQoZ3J1cG8pO1xyXG4gIH0pO1xyXG5cclxuICBmdW5jdGlvbiBjcmVhckdydXBvKGdydXBvOiBHcnVwb0NvbmV4aW9uW10sIGxhZG86ICdpenEnIHwgJ2RlcicpIHtcclxuICAgIGdydXBvLmZvckVhY2goKG9yaWdlbikgPT4ge1xyXG4gICAgICBjb25zdCBncnVwbyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnZycpO1xyXG4gICAgICBncnVwby5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ29yaWdlbicpO1xyXG4gICAgICBjb25zdCB4R3J1cG8gPSBsYWRvID09PSAnaXpxJyA/ICczcHgnIDogJ2NhbGMoMTAwJSAtIDVweCknO1xyXG4gICAgICBncnVwby5zZXRBdHRyaWJ1dGUoXHJcbiAgICAgICAgJ3N0eWxlJyxcclxuICAgICAgICBgdHJhbnNmb3JtOiB0cmFuc2xhdGUoJHt4R3J1cG99LCAke29yaWdlbi55fXB4KTtmaWxsOiR7Y29sb3Jlc0dydXBvc1tvcmlnZW4ubGxhdmUgYXMga2V5b2YgTGxhdmVzRVZdfTtgXHJcbiAgICAgICk7XHJcbiAgICAgIGNvbnN0IG5vbWJyZUdydXBvID0gZWRhZFZpY3RpbWFzLm5vbWJyZXNbb3JpZ2VuLmxsYXZlIGFzIGtleW9mIExsYXZlc0VWXTtcclxuICAgICAgY29uc3Qgc2VtaWxsYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncmVjdCcpO1xyXG4gICAgICBzZW1pbGxhLnNldEF0dHJpYnV0ZSgneCcsIGxhZG8gPT09ICdpenEnID8gJzAnIDogJy00MHB4Jyk7XHJcbiAgICAgIHNlbWlsbGEuc2V0QXR0cmlidXRlKCd5JywgJzAnKTtcclxuICAgICAgc2VtaWxsYS5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgJzQwcHgnKTtcclxuICAgICAgc2VtaWxsYS5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsIGAke2FsdG8ob3JpZ2VuLnZhbG9yKX1weGApO1xyXG5cclxuICAgICAgY29uc3Qgbm9tYnJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICd0ZXh0Jyk7XHJcbiAgICAgIG5vbWJyZS5zZXRBdHRyaWJ1dGUoJ3gnLCAnMCcpO1xyXG4gICAgICBub21icmUuc2V0QXR0cmlidXRlKCd5JywgJy0xN3B4Jyk7XHJcbiAgICAgIG5vbWJyZS5zZXRBdHRyaWJ1dGUoJ2ZvbnQtd2VpZ2h0JywgJ2JvbGQnKTtcclxuICAgICAgbm9tYnJlLnNldEF0dHJpYnV0ZSgnZm9udC1zaXplJywgJzE1Jyk7XHJcbiAgICAgIGlmIChsYWRvID09PSAnZGVyJykgbm9tYnJlLnNldEF0dHJpYnV0ZSgndGV4dC1hbmNob3InLCAnZW5kJyk7XHJcbiAgICAgIG5vbWJyZS5pbm5lckhUTUwgPSBub21icmVHcnVwbztcclxuXHJcbiAgICAgIGNvbnN0IHZhbG9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICd0ZXh0Jyk7XHJcbiAgICAgIHZhbG9yLnNldEF0dHJpYnV0ZSgneCcsICcwJyk7XHJcbiAgICAgIHZhbG9yLnNldEF0dHJpYnV0ZSgneScsICctM3B4Jyk7XHJcbiAgICAgIHZhbG9yLnNldEF0dHJpYnV0ZSgnZm9udC1zaXplJywgJzExJyk7XHJcbiAgICAgIGlmIChsYWRvID09PSAnZGVyJykgdmFsb3Iuc2V0QXR0cmlidXRlKCd0ZXh0LWFuY2hvcicsICdlbmQnKTtcclxuICAgICAgdmFsb3IuaW5uZXJIVE1MID0gYCR7b3JpZ2VuLnZhbG9yfSVgO1xyXG5cclxuICAgICAgb3JpZ2VuLmNvbmV4aW9uZXMuZm9yRWFjaCgoY29uZXhpb24pID0+IHtcclxuICAgICAgICBjb25zdCBlbGVtZW50byA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncGF0aCcpO1xyXG4gICAgICAgIGVsZW1lbnRvLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCBgY29uZXhpb24gYyR7b3JpZ2VuLmxsYXZlfWApO1xyXG4gICAgICAgIGVsZW1lbnRvLnNldEF0dHJpYnV0ZSgnZCcsIGN1cnZhKGNvbmV4aW9uLCBsYWRvKSk7XHJcbiAgICAgICAgZWxlbWVudG8uc2V0QXR0cmlidXRlKCdmaWxsJywgY29uZXhpb24uY29sb3IpO1xyXG4gICAgICAgIGVsZW1lbnRvLnNldEF0dHJpYnV0ZSgnZGF0YS1kYXRvcycsIEpTT04uc3RyaW5naWZ5KGNvbmV4aW9uKSk7XHJcbiAgICAgICAgZWxlbWVudG8uc2V0QXR0cmlidXRlKCdkYXRhLWxhZG8nLCBsYWRvKTtcclxuXHJcbiAgICAgICAgZWxlbWVudG8uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IHtcclxuICAgICAgICAgIGNvbnRlbmVkb3JJbmZvLmlubmVySFRNTCA9IGNyZWFyTWVuc2FqZShjb25leGlvbiwgbm9tYnJlR3J1cG8sIGxhZG8pO1xyXG4gICAgICAgICAgc3ZnPy5jbGFzc0xpc3QuYWRkKCdpbnRlcmFjdHVhbmRvJyk7XHJcbiAgICAgICAgICBpbmZvLm1vc3RyYXIoKTtcclxuICAgICAgICAgIGVsZW1lbnRvLmNsYXNzTGlzdC5hZGQoJ2FjdGl2bycpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBlbGVtZW50by5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xyXG4gICAgICAgICAgc3ZnPy5xdWVyeVNlbGVjdG9yKCcuY29uZXhpb24uYWN0aXZvJyk/LmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2bycpO1xyXG4gICAgICAgICAgaW5mby5lc2NvbmRlcigpO1xyXG4gICAgICAgICAgc3ZnPy5jbGFzc0xpc3QucmVtb3ZlKCdpbnRlcmFjdHVhbmRvJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGVsZW1lbnRvLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIChldmVudG8pID0+IHtcclxuICAgICAgICAgIE9iamVjdC5hc3NpZ24oY29udGVuZWRvckluZm8uc3R5bGUsIHtcclxuICAgICAgICAgICAgdG9wOiBgJHtldmVudG8ucGFnZVkgLSBjb250ZW5lZG9ySW5mby5jbGllbnRIZWlnaHQgLSAxMH1weGAsXHJcbiAgICAgICAgICAgIGxlZnQ6IGAke2V2ZW50by5wYWdlWH1weGAsXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25leGlvbmVzPy5hcHBlbmRDaGlsZChlbGVtZW50byk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgZ3J1cG8uYXBwZW5kQ2hpbGQoc2VtaWxsYSk7XHJcbiAgICAgIGdydXBvLmFwcGVuZENoaWxkKG5vbWJyZSk7XHJcbiAgICAgIGdydXBvLmFwcGVuZENoaWxkKHZhbG9yKTtcclxuXHJcbiAgICAgIHNlbWlsbGFzPy5hcHBlbmQoZ3J1cG8pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBwcm9jZXNhckdydXBvRXRhcmlvKGdydXBvOiBHcnVwb0VWKSB7XHJcbiAgICBsZXQgeUFjdW11bGFkbyA9IDA7XHJcblxyXG4gICAgcmV0dXJuIGxsYXZlc1xyXG4gICAgICAuc29ydCgoYSwgYikgPT4gZ3J1cG8udG90YWxlc1tiIGFzIGtleW9mIExsYXZlc0VWXSAtIGdydXBvLnRvdGFsZXNbYSBhcyBrZXlvZiBMbGF2ZXNFVl0pXHJcbiAgICAgIC5tYXAoKG5vbWJyZSwgaSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHZhbG9yID0gZ3J1cG8udG90YWxlc1tub21icmUgYXMga2V5b2YgTGxhdmVzRVZdO1xyXG4gICAgICAgIGNvbnN0IHkgPSBlc3BhY2lvRW50cmUgKiAoaSArIDEpICsgbWFyZ2VuWSArIHlBY3VtdWxhZG87XHJcbiAgICAgICAgY29uc3QgYWN1bXVsYWRvczogTGxhdmVzRVYgPSB7IG1lbm9yMTQ6IDAsIGVudHJlMTR5MTU6IDAsIGVudHJlMTZ5MTc6IDAgfTtcclxuXHJcbiAgICAgICAgY29uc3QgY29uZXhpb25lcyA9IGdydXBvLmRhdG9zXHJcbiAgICAgICAgICAubWFwKChsdWdhcikgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB2YWxvckxpbmVhID0gbHVnYXJbbm9tYnJlIGFzIGtleW9mIExsYXZlc0VWXTtcclxuICAgICAgICAgICAgYWN1bXVsYWRvc1tub21icmUgYXMga2V5b2YgTGxhdmVzRVZdICs9IHZhbG9yTGluZWE7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgIHBhaXM6IGx1Z2FyLnBhaXMsXHJcbiAgICAgICAgICAgICAgb3JpZ2VuOiBub21icmUsXHJcbiAgICAgICAgICAgICAgdmFsb3I6IHZhbG9yTGluZWEsXHJcbiAgICAgICAgICAgICAgb3JpZ2VuWTE6IDAsXHJcbiAgICAgICAgICAgICAgb3JpZ2VuWTI6IDAsXHJcbiAgICAgICAgICAgICAgZGVzdGlub1kxOiAwLFxyXG4gICAgICAgICAgICAgIGRlc3Rpbm9ZMjogMCxcclxuICAgICAgICAgICAgICBjb2xvcjogY29sb3Jlc0dydXBvc1tub21icmUgYXMga2V5b2YgTGxhdmVzRVZdLFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5zb3J0KChhLCBiKSA9PiBiLnZhbG9yIC0gYS52YWxvcik7XHJcblxyXG4gICAgICAgIGNvbnN0IHJlc3B1ZXN0YSA9IHtcclxuICAgICAgICAgIGxsYXZlOiBub21icmUgYXMga2V5b2YgTGxhdmVzRVYsXHJcbiAgICAgICAgICB5LFxyXG4gICAgICAgICAgdmFsb3IsXHJcbiAgICAgICAgICBjb25leGlvbmVzLFxyXG4gICAgICAgICAgdG90YWxPcmlnZW46IGFjdW11bGFkb3Nbbm9tYnJlIGFzIGtleW9mIExsYXZlc0VWXSB8IDAsXHJcbiAgICAgICAgfTtcclxuICAgICAgICB5QWN1bXVsYWRvICs9IGFsdG8odmFsb3IpO1xyXG4gICAgICAgIHJldHVybiByZXNwdWVzdGE7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZGVmaW5pckNvbmV4aW9uZXMoKSB7XHJcbiAgICBvcmlnZW5lc011amVyZXMuZm9yRWFjaCgob3JpZ2VuLCBpKSA9PiB7XHJcbiAgICAgIGNvbnN0IGVzY2FsYVlPcmlnZW4gPSAobjogbnVtYmVyKSA9PiBhbHRvKGNvbnZlcnRpckVzY2FsYShuLCAwLCBvcmlnZW4udG90YWxPcmlnZW4sIDAsIG9yaWdlbi52YWxvciAtIDQuNCkpO1xyXG4gICAgICBjb25zdCBlc2NhbGFZRGVzdGlubyA9IChuOiBudW1iZXIpID0+IGFsdG8oY29udmVydGlyRXNjYWxhKG4sIDAsIDEwMCwgMCwgMTApKTtcclxuICAgICAgb3JpZ2VuLmNvbmV4aW9uZXMuZm9yRWFjaCgobHVnYXIsIGlpKSA9PiB7XHJcbiAgICAgICAgY29uc3QgcGFpcyA9IHBhaXNlcy5maW5kKChwYWlzKSA9PiBwYWlzLm5vbWJyZSA9PT0gbHVnYXIucGFpcyk7XHJcbiAgICAgICAgY29uc3QgeTIgPSBpID4gMCA/IG9yaWdlbmVzTXVqZXJlc1tpIC0gMV0uY29uZXhpb25lcy5maW5kKChsKSA9PiBsLnBhaXMgPT09IGx1Z2FyLnBhaXMpPy5kZXN0aW5vWTIgOiBwYWlzPy55O1xyXG5cclxuICAgICAgICBsdWdhci5vcmlnZW5ZMSA9IGlpID09PSAwID8gb3JpZ2VuLnkgOiBvcmlnZW4uY29uZXhpb25lc1tpaSAtIDFdLm9yaWdlblkyO1xyXG4gICAgICAgIGx1Z2FyLm9yaWdlblkyID0gbHVnYXIub3JpZ2VuWTE7XHJcbiAgICAgICAgbHVnYXIub3JpZ2VuWTIgKz0gZXNjYWxhWU9yaWdlbihsdWdhci52YWxvcik7XHJcbiAgICAgICAgbHVnYXIuZGVzdGlub1kxID0geTIgfHwgMDtcclxuICAgICAgICBsdWdhci5kZXN0aW5vWTIgPSBsdWdhci5kZXN0aW5vWTE7XHJcbiAgICAgICAgbHVnYXIuZGVzdGlub1kyICs9IGVzY2FsYVlEZXN0aW5vKGx1Z2FyLnZhbG9yKSB8IDA7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgb3JpZ2VuZXNNdWplcmVzLnJldmVyc2UoKTsgLy8gaW52ZXJ0aXIgb3JkZW4gcGFyYSBxdWUgc2UgcGludGVuIGxhcyBtw6FzIGdydWVzYXMgZW5jaW1hIGRlIGxhcyBtZW5vc1xyXG5cclxuICAgIG9yaWdlbmVzSG9tYnJlcy5mb3JFYWNoKChkZXN0aW5vLCBpKSA9PiB7XHJcbiAgICAgIGNvbnN0IGVzY2FsYVlPcmlnZW4gPSAobjogbnVtYmVyKSA9PiBhbHRvKGNvbnZlcnRpckVzY2FsYShuLCAwLCAxMDAsIDAsIDEwKSk7XHJcbiAgICAgIGNvbnN0IGVzY2FsYVlEZXN0aW5vID0gKG46IG51bWJlcikgPT4gYWx0byhjb252ZXJ0aXJFc2NhbGEobiwgMCwgZGVzdGluby50b3RhbE9yaWdlbiwgMCwgZGVzdGluby52YWxvciAtIDIpKTtcclxuXHJcbiAgICAgIGRlc3Rpbm8uY29uZXhpb25lcy5mb3JFYWNoKChsdWdhciwgaWkpID0+IHtcclxuICAgICAgICBjb25zdCBwYWlzID0gcGFpc2VzLmZpbmQoKHBhaXMpID0+IHBhaXMubm9tYnJlID09PSBsdWdhci5wYWlzKTtcclxuICAgICAgICBjb25zdCB5MSA9IGkgPT09IDAgPyBwYWlzPy55IDogb3JpZ2VuZXNIb21icmVzW2kgLSAxXS5jb25leGlvbmVzLmZpbmQoKGwpID0+IGwucGFpcyA9PT0gbHVnYXIucGFpcyk/Lm9yaWdlblkyO1xyXG5cclxuICAgICAgICBsdWdhci5vcmlnZW5ZMSA9IHkxIHx8IDA7XHJcbiAgICAgICAgbHVnYXIub3JpZ2VuWTIgPSBsdWdhci5vcmlnZW5ZMTtcclxuICAgICAgICBsdWdhci5vcmlnZW5ZMiArPSBlc2NhbGFZT3JpZ2VuKGx1Z2FyLnZhbG9yKTtcclxuICAgICAgICBsdWdhci5kZXN0aW5vWTEgPSBpaSA9PT0gMCA/IGRlc3Rpbm8ueSA6IGRlc3Rpbm8uY29uZXhpb25lc1tpaSAtIDFdLmRlc3Rpbm9ZMjtcclxuICAgICAgICBsdWdhci5kZXN0aW5vWTIgPSBsdWdhci5kZXN0aW5vWTE7XHJcbiAgICAgICAgbHVnYXIuZGVzdGlub1kyICs9IGVzY2FsYVlEZXN0aW5vKGx1Z2FyLnZhbG9yKSB8IDA7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgb3JpZ2VuZXNIb21icmVzLnJldmVyc2UoKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGN1cnZhKGNvbmV4aW9uOiBDb25leGlvbiwgbGFkbzogJ2l6cScgfCAnZGVyJykge1xyXG4gICAgY29uc3QgYW5jaG9HcmFmaWNhID0gc3ZnPy5jbGllbnRXaWR0aCB8fCAwO1xyXG4gICAgY29uc3QgbWl0YWQgPSBhbmNob0dyYWZpY2EgLyAyO1xyXG4gICAgY29uc3QgY2VudHJvQ3VydmEgPSBsYWRvID09PSAnaXpxJyA/IG1pdGFkIC8gMiAtIG1hcmdlbkNlbnRybyA6IG1pdGFkICsgbWFyZ2VuQ2VudHJvICsgbWl0YWQgLyAyO1xyXG4gICAgY29uc3QgeE9yaWdlbiA9IGxhZG8gPT09ICdpenEnID8gNDAgOiBtaXRhZCArIG1hcmdlbkNlbnRybztcclxuICAgIGNvbnN0IHhEZXN0aW5vID0gbGFkbyA9PT0gJ2l6cScgPyBtaXRhZCAtIG1hcmdlbkNlbnRybyA6IGFuY2hvR3JhZmljYSAtIDQ0O1xyXG4gICAgY29uc3QgeDEgPSBjZW50cm9DdXJ2YTtcclxuICAgIGNvbnN0IHgyID0gY2VudHJvQ3VydmE7XHJcbiAgICBjb25zdCB5MSA9IGNvbmV4aW9uLm9yaWdlblkxO1xyXG4gICAgY29uc3QgeTIgPSBjb25leGlvbi5kZXN0aW5vWTE7XHJcbiAgICBsZXQgZm9ybWEgPSBgTSR7eE9yaWdlbn0sJHtjb25leGlvbi5vcmlnZW5ZMX1gO1xyXG5cclxuICAgIGZvcm1hICs9IGAgQyR7eDF9LCR7eTF9YDtcclxuICAgIGZvcm1hICs9IGAgJHt4Mn0sJHt5Mn1gO1xyXG4gICAgZm9ybWEgKz0gYCAke3hEZXN0aW5vfSwke2NvbmV4aW9uLmRlc3Rpbm9ZMX1gO1xyXG4gICAgZm9ybWEgKz0gYEwke3hEZXN0aW5vfSwke2NvbmV4aW9uLmRlc3Rpbm9ZMn1gO1xyXG4gICAgY29uc3QgeDMgPSBjZW50cm9DdXJ2YTtcclxuICAgIGNvbnN0IHkzID0gY29uZXhpb24uZGVzdGlub1kyO1xyXG4gICAgY29uc3QgeDQgPSBjZW50cm9DdXJ2YTtcclxuICAgIGNvbnN0IHk0ID0gY29uZXhpb24ub3JpZ2VuWTI7XHJcbiAgICBmb3JtYSArPSBgIEMke3gzfSwke3kzfWA7XHJcbiAgICBmb3JtYSArPSBgICR7eDR9LCR7eTR9YDtcclxuICAgIGZvcm1hICs9IGAgJHt4T3JpZ2VufSwke2NvbmV4aW9uLm9yaWdlblkyfWA7XHJcbiAgICBmb3JtYSArPSAnWic7XHJcbiAgICByZXR1cm4gZm9ybWE7XHJcbiAgfVxyXG5cclxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgKCkgPT4ge1xyXG4gICAgaWYgKCFzdmcpIHJldHVybjtcclxuXHJcbiAgICBjb25zdCBjb25leGlvbmVzID0gc3ZnLnF1ZXJ5U2VsZWN0b3JBbGw8U1ZHUGF0aEVsZW1lbnQ+KCcuY29uZXhpb24nKTtcclxuXHJcbiAgICBpZiAoY29uZXhpb25lcy5sZW5ndGgpIHtcclxuICAgICAgY29uZXhpb25lcy5mb3JFYWNoKChjb25leGlvbikgPT4ge1xyXG4gICAgICAgIGNvbnN0IHsgZGF0b3MsIGxhZG8gfSA9IGNvbmV4aW9uLmRhdGFzZXQ7XHJcbiAgICAgICAgaWYgKGRhdG9zICYmIGxhZG8pIGNvbmV4aW9uLnNldEF0dHJpYnV0ZSgnZCcsIGN1cnZhKEpTT04ucGFyc2UoZGF0b3MpLCBsYWRvIGFzICdpenEnIHwgJ2RlcicpKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIGZ1bmN0aW9uIGNyZWFySW50ZXJhY2Npb25lcygpIHtcclxuICAgIC8vIGNvbnN0IGVwVW5UZXJjaW8xNCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlcFVuVGVyY2lvMTQnKTtcclxuICAgIC8vIGlmIChlcFVuVGVyY2lvMTQpIHtcclxuICAgIC8vICAgZXBVblRlcmNpbzE0Lm9ubW91c2VlbnRlciA9ICgpID0+IHtcclxuICAgIC8vICAgICBpZiAoIXN2ZykgcmV0dXJuO1xyXG4gICAgLy8gICAgIGNvbnN0IGNvbmV4aW9uZXMgPSBzdmcucXVlcnlTZWxlY3RvckFsbDxTVkdQYXRoRWxlbWVudD4oJy5jb25leGlvbicpO1xyXG4gICAgLy8gICAgIHN2Zy5jbGFzc0xpc3QuYWRkKCdpbnRlcmFjdHVhbmRvJyk7XHJcbiAgICAvLyAgICAgY29uZXhpb25lcy5mb3JFYWNoKChjb25leGlvbikgPT4ge1xyXG4gICAgLy8gICAgICAgY29uZXhpb24uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZvJyk7XHJcbiAgICAvLyAgICAgfSk7XHJcbiAgICAvLyAgICAgY29uc3QgbWVub3IxNCA9IHN2Zy5xdWVyeVNlbGVjdG9yQWxsKGAuY29uZXhpb24uY21lbm9yMTRgKTtcclxuICAgIC8vICAgICBpZiAobWVub3IxNC5sZW5ndGgpIHtcclxuICAgIC8vICAgICAgIG1lbm9yMTQuZm9yRWFjaCgobm9kbykgPT4gbm9kby5jbGFzc0xpc3QuYWRkKCdhY3Rpdm8nKSk7XHJcbiAgICAvLyAgICAgfVxyXG4gICAgLy8gICB9O1xyXG4gICAgLy8gICBlcFVuVGVyY2lvMTQub25tb3VzZWxlYXZlID0gKCkgPT4ge1xyXG4gICAgLy8gICAgIGlmICghc3ZnKSByZXR1cm47XHJcbiAgICAvLyAgICAgY29uc3QgY29uZXhpb25lcyA9IHN2Zy5xdWVyeVNlbGVjdG9yQWxsPFNWR1BhdGhFbGVtZW50PignLmNvbmV4aW9uJyk7XHJcbiAgICAvLyAgICAgc3ZnLmNsYXNzTGlzdC5yZW1vdmUoJ2ludGVyYWN0dWFuZG8nKTtcclxuICAgIC8vICAgICBjb25leGlvbmVzLmZvckVhY2goKGNvbmV4aW9uKSA9PiB7XHJcbiAgICAvLyAgICAgICBjb25leGlvbi5jbGFzc0xpc3QucmVtb3ZlKCdhY3Rpdm8nKTtcclxuICAgIC8vICAgICB9KTtcclxuICAgIC8vICAgfTtcclxuICAgIC8vIH1cclxuICAgIC8vIGNvbnN0IGVwVW5UZXJjaW8xNSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlcFVuVGVyY2lvMTUnKTtcclxuICAgIC8vIGlmIChlcFVuVGVyY2lvMTUpIHtcclxuICAgIC8vICAgZXBVblRlcmNpbzE1Lm9ubW91c2VlbnRlciA9ICgpID0+IHtcclxuICAgIC8vICAgICBpZiAoIXN2ZykgcmV0dXJuO1xyXG4gICAgLy8gICAgIGNvbnN0IGNvbmV4aW9uZXMgPSBzdmcucXVlcnlTZWxlY3RvckFsbDxTVkdQYXRoRWxlbWVudD4oJy5jb25leGlvbicpO1xyXG4gICAgLy8gICAgIHN2Zy5jbGFzc0xpc3QuYWRkKCdpbnRlcmFjdHVhbmRvJyk7XHJcbiAgICAvLyAgICAgY29uZXhpb25lcy5mb3JFYWNoKChjb25leGlvbikgPT4ge1xyXG4gICAgLy8gICAgICAgY29uZXhpb24uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZvJyk7XHJcbiAgICAvLyAgICAgfSk7XHJcbiAgICAvLyAgICAgY29uc3QgbWVub3IxNSA9IHN2Zy5xdWVyeVNlbGVjdG9yQWxsKGAuY29uZXhpb24uY2VudHJlMTV5MThgKTtcclxuICAgIC8vICAgICBpZiAobWVub3IxNS5sZW5ndGgpIHtcclxuICAgIC8vICAgICAgIG1lbm9yMTUuZm9yRWFjaCgobm9kbykgPT4gbm9kby5jbGFzc0xpc3QuYWRkKCdhY3Rpdm8nKSk7XHJcbiAgICAvLyAgICAgfVxyXG4gICAgLy8gICB9O1xyXG4gICAgLy8gICBlcFVuVGVyY2lvMTUub25tb3VzZWxlYXZlID0gKCkgPT4ge1xyXG4gICAgLy8gICAgIGlmICghc3ZnKSByZXR1cm47XHJcbiAgICAvLyAgICAgY29uc3QgY29uZXhpb25lcyA9IHN2Zy5xdWVyeVNlbGVjdG9yQWxsPFNWR1BhdGhFbGVtZW50PignLmNvbmV4aW9uJyk7XHJcbiAgICAvLyAgICAgc3ZnLmNsYXNzTGlzdC5yZW1vdmUoJ2ludGVyYWN0dWFuZG8nKTtcclxuICAgIC8vICAgICBjb25leGlvbmVzLmZvckVhY2goKGNvbmV4aW9uKSA9PiB7XHJcbiAgICAvLyAgICAgICBjb25leGlvbi5jbGFzc0xpc3QucmVtb3ZlKCdhY3Rpdm8nKTtcclxuICAgIC8vICAgICB9KTtcclxuICAgIC8vICAgfTtcclxuICAgIC8vIH1cclxuICB9XHJcbjwvc2NyaXB0PiJdLCJtYXBwaW5ncyI6IkFBY0UsU0FBUyxvQkFBb0I7QUFDN0IsT0FBTyxVQUFVO0FBRWpCLFNBQVMsbUJBQW1CO0FBQzVCLFNBQVMsdUJBQXVCO0FBRWhDLE1BQU0sTUFBTSxTQUFTLGNBQTJCLGNBQWM7QUFDOUQsSUFBSSxDQUFDLElBQUssT0FBTSxJQUFJLE1BQU0sZ0NBQStCO0FBQ3pELE1BQU0sV0FBVyxJQUFJLGNBQTJCLFdBQVc7QUFDM0QsTUFBTSxhQUFhLElBQUksY0FBMkIsYUFBYTtBQUUvRCxNQUFNLGlCQUFpQixLQUFLLFNBQVM7QUFDckMsTUFBTSxFQUFFLFNBQVMsUUFBUSxJQUFJLGFBQWEsS0FBSztBQUMvQyxNQUFNLEVBQUUsTUFBTSxTQUFTLGNBQWMsYUFBYSxJQUFJLFlBQVksR0FBRztBQUNyRSxNQUFNLFNBQVMsT0FBTyxLQUFLLGFBQWEsT0FBTyxFQUFFLE9BQU8sQ0FBQyxXQUFXLFdBQVcsR0FBRztBQUVsRixNQUFNLGdCQUFnQjtFQUNwQixTQUFTO0VBQ1QsWUFBWTtFQUNaLFlBQVk7QUFDZDtBQUNBLE1BQU0sZUFBZSxDQUFDLFVBQW9CLGFBQXFCLFNBQXdCO0FBQ3JGLFFBQU0sU0FBUyxTQUFTLFFBQVEsV0FBVztBQUMzQyxNQUFJ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SUFBSSxHQUFHO0FBRXJHLFlBQU0sV0FBVyxNQUFNO0FBQ3ZCLFlBQU0sV0FBVyxNQUFNO0FBQ3ZCLFlBQU0sWUFBWSxjQUFjLE1BQU0sS0FBSztBQUMzQyxZQUFNLFlBQVksT0FBTyxJQUFJLFFBQVEsSUFBSSxRQUFRLFdBQVcsS0FBSyxDQUFDLEVBQUU7QUFDcEUsWUFBTSxZQUFZLE1BQU07QUFDeEIsWUFBTSxhQUFhLGVBQWUsTUFBTSxLQUFLLElBQUk7SUFDbkQsQ0FBQztFQUNILENBQUM7QUFFRCxrQkFBZ0IsUUFBUTtBQUMxQjtBQUVBLFNBQVMsTUFBTSxVQUFvQixNQUFxQjtBQUN0RCxRQUFNLGVBQWUsS0FBSyxlQUFlO0FBQ3pDLFFBQU0sUUFBUSxlQUFlO0FBQzdCLFFBQU0sY0FBYyxTQUFTLFFBQVEsUUFBUSxJQUFJLGVBQWUsUUFBUSxlQUFlLFFBQVE7QUFDL0YsUUFBTSxVQUFVLFNBQVMsUUFBUSxLQUFLLFFBQVE7QUFDOUMsUUFBTSxXQUFXLFNBQVMsUUFBUSxRQUFRLGVBQWUsZUFBZTtBQUN4RSxRQUFNLEtBQUs7QUFDWCxRQUFNLEtBQUs7QUFDWCxRQUFNLEtBQUssU0FBUztBQUNwQixRQUFNLEtBQUssU0FBUztBQUNwQixNQUFJLFFBQVEsSUFBSSxPQUFPLElBQUksU0FBUyxRQUFRO0FBRTVDLFdBQVMsS0FBSyxFQUFFLElBQUksRUFBRTtBQUN0QixXQUFTLElBQUksRUFBRSxJQUFJLEVBQUU7QUFDckIsV0FBUyxJQUFJLFFBQVEsSUFBSSxTQUFTLFNBQVM7QUFDM0MsV0FBUyxJQUFJLFFBQVEsSUFBSSxTQUFTLFNBQVM7QUFDM0MsUUFBTSxLQUFLO0FBQ1gsUUFBTSxLQUFLLFNBQVM7QUFDcEIsUUFBTSxLQUFLO0FBQ1gsUUFBTSxLQUFLLFNBQVM7QUFDcEIsV0FBUyxLQUFLLEVBQUUsSUFBSSxFQUFFO0FBQ3RCLFdBQVMsSUFBSSxFQUFFLElBQUksRUFBRTtBQUNyQixXQUFTLElBQUksT0FBTyxJQUFJLFNBQVMsUUFBUTtBQUN6QyxXQUFTO0FBQ1QsU0FBTztBQUNUO0FBRUEsT0FBTyxpQkFBaUIsVUFBVSxNQUFNO0FBQ3RDLE1BQUksQ0FBQyxJQUFLO0FBRVYsUUFBTUQsY0FBYSxJQUFJLGlCQUFpQyxXQUFXO0FBRW5FLE1BQUlBLFlBQVcsUUFBUTtBQUNyQixJQUFBQSxZQUFXLFFBQVEsQ0FBQyxhQUFhO0FBQy9CLFlBQU0sRUFBRSxPQUFPLEtBQUssSUFBSSxTQUFTO0FBQ2pDLFVBQUksU0FBUyxLQUFNLFVBQVMsYUFBYSxLQUFLLE1BQU0sS0FBSyxNQUFNLEtBQUssR0FBRyxJQUFxQixDQUFDO0lBQy9GLENBQUM7RUFDSDtBQUNGLENBQUM7QUFFRCxTQUFTLHFCQUFxQjtBQStDOUI7IiwibmFtZXMiOlsiZ3J1cG8iLCJjb25leGlvbmVzIiwicGFpcyJdfQ==